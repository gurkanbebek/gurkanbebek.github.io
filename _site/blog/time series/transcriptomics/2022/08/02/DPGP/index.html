<!DOCTYPE html>

<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">

		<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>DPGP | systems.bio</title>
<meta name="generator" content="Jekyll v3.9.2" />
<meta property="og:title" content="DPGP" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Time series analysis for large omic datasets?" />
<meta property="og:description" content="Time series analysis for large omic datasets?" />
<link rel="canonical" href="http://localhost:4000/blog/time%20series/transcriptomics/2022/08/02/DPGP/" />
<meta property="og:url" content="http://localhost:4000/blog/time%20series/transcriptomics/2022/08/02/DPGP/" />
<meta property="og:site_name" content="systems.bio" />
<meta property="og:image" content="https://journals.plos.org/ploscompbiol/article/figure/image?size=large&id=10.1371/journal.pcbi.1005896.g003" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-08-02T00:00:00+00:00" />
<script type="application/ld+json">
{"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/blog/time%20series/transcriptomics/2022/08/02/DPGP/"},"image":"https://journals.plos.org/ploscompbiol/article/figure/image?size=large&id=10.1371/journal.pcbi.1005896.g003","url":"http://localhost:4000/blog/time%20series/transcriptomics/2022/08/02/DPGP/","@type":"BlogPosting","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://localhost:4000/siteicon.png"}},"description":"Time series analysis for large omic datasets?","headline":"DPGP","dateModified":"2022-08-02T00:00:00+00:00","datePublished":"2022-08-02T00:00:00+00:00","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

		<link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="systems.bio" />

		<link rel="apple-touch-icon" href="//apple-touch-icon.png">
		<link rel="icon" type="image/png" href="//touch-icon.png" sizes="192x192">
		<link rel="icon" type="image/png" href="//images/favicon.png">

		<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:300|Rubik:300">
		<link rel="stylesheet" href="//css/screen.css">

		
	</head>

	<body>
		<header id="mainHeader">
			<div class="container">
				<div class="company-name">
					<a href="//">
						<span class="dark-logo"><img width="104" height="38" src="//images/logo/dark.svg" alt="dark logo"></span>
						<span class="light-logo"><img width="104" height="38" src="//images/logo/light.svg" alt="light logo"></span>
					</a>
				</div>
				<nav>
	<a class="nav-toggle" id="open-nav" href="#">&#9776;</a>
	
		
		

		
		<a href="//about/" class="" >About</a>
	
		
		

		
		<a href="//papers/" class="" >Contributions</a>
	
		
		

		
		<a href="//blog/" class="" >Blog</a>
	
		
		

		
		<a href="//contact/" class="" >Contact</a>
	
</nav>

				<p class="editor-link"><a style="display:inline;" href="cloudcannon:collections/_data/navigation.yml" class="btn"><strong>&#9998;</strong> Edit navigation</a></p>
			</div>
		</header>

		<section class="hero" style="background-image: url(https://journals.plos.org/ploscompbiol/article/figure/image?size=large&id=10.1371/journal.pcbi.1005896.g003)">
	<div class="inner-hero text-container">
		<div class="hero-text-container">
			<h1>DPGP</h1>
			<p class="subtext">Time series analysis for large omic datasets?</p>
		</div>
	</div>
</section>

<section>
	<div class="blog-post text-container">
		<p class="editor-link"><a href="cloudcannon:collections/blog/_posts/2022-08-02-DPGP.md" class="btn"><strong>&#9998;</strong> Edit Post</a></p>
		<p class="post-details">
	
		<span class="blog-filter">
			<a href="//category/blog/">Blog</a>
		</span>
	
		<span class="blog-filter">
			<a href="//category/time-series/">Time series</a>
		</span>
	
		<span class="blog-filter">
			<a href="//category/transcriptomics/">Transcriptomics</a>
		</span>
	
	<span class="post-date">August 02, 2022</span>
</p>


		<div class="post-content">
			<p>DPGP is a Dirichlet process time series clustering tool. DPGP generates the trajectories of gene expression levels across time, where the trajectories are clustered transcriptional time series data with an infinite mixture of Gaussian processes modeled using a Gaussian process. DPGP compared to state-of-the-art time series clustering methods across a variety of simulated data performs much better. DPGP can be used for exploratory data analysis of gene expression time series to reveal novel insights into biomedically important gene regulatory processes. (<a href="https://doi.org/10.1371/journal.pcbi.1005896">see paper</a>).</p>

<meta property="og:image" content="https://unsplash.com/photos/9wYdW55NbnY/download?w=1000" />

<meta name="twitter:image" content="https://unsplash.com/photos/9wYdW55NbnY/download?w=1000" />

<p>DPGP software is freely available on <a href="https://github.com/PrincetonUniversity/DP_GP_cluster">github</a>.</p>

<p>Here are steps to make it work (on linux).</p>

<h4 id="1-we-will-first-download-dpgp-software-from-github">1. We will first download DPGP software from github.</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mkdir DPGP
cd DPGP
git clone https://github.com/PrincetonUniversity/DP_GP_cluster.git
</code></pre></div></div>

<h4 id="2-next-we-need-to-make-some-modifications-to-make-dpgp-work-unfortunately-due-to-python-updates-the-code-needs-fixing">2. Next, we need to make some modifications to make DPGP work. Unfortunately, due to python updates, the code needs fixing.</h4>

<h5 id="in-dp-gp-clusterpy-file-uncomment-lines-to-change">In DP GP cluster.py file, uncomment lines to change:</h5>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>import matplotlib.pyplot as plt
</code></pre></div></div>

<h4 id="to">to</h4>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>import matplotlib
matplotlib.use('Agg')
import matplotlib.pyplot as plt
</code></pre></div></div>

<h4 id="3-dp-gp-cluster-requires-the-following-python-packages-gpy-pandas-numpy-scipy--014-matplotlibpyplot">3. DP GP cluster requires the following Python packages: GPy, pandas, numpy, scipy (&gt;= 0.14), matplotlib.pyplot</h4>

<h5 id="dpgp-has-been-tested-in-linux-with-python-27-and-with-anaconda-distributions-of-the-latter-four-above-packages-however-since-2018-things-have-changed-we-will-need-to-enforce-versioning">”DPGP has been tested in linux with Python 2.7 and with Anaconda distributions of the latter four above packages.” However, since 2018 things have changed. We will need to enforce versioning.</h5>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pip install --user GPy==1.9.8 pandas numpy scipy matplotlib cython scikit-learn


With Python 3.10:
pip install --user GPy==1.9.8 pandas numpy scipy matplotlib cython scikit-learn --use-pep517
 
</code></pre></div></div>

<h4 id="4-finally-we-can-install-dpgp">4. Finally, we can install DPGP:</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python setup.py install --user
</code></pre></div></div>

<p>This will install /home/gxb43/.local/bin/DP_GP_cluster.py</p>

<h4 id="5-tests">5. Tests</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cd DP_GP_cluster
DP_GP_cluster.py -i test/test.txt -o test/test -p png -n 20 --plot
</code></pre></div></div>

<h4 id="6-plots">6. plots</h4>

<p>Because the optimal clustering is chosen after the entirety of Gibbs sampling, the script can be rerun with alternative clustering optimality criteria to yield different sets of clusters. Also, if <code class="language-plaintext highlighter-rouge">--plot</code> flag was not indicated when the above script is called, plots can be generated after sampling:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>DP_GP_cluster.py \
    -i /path/to/expression.txt \
    --sim_mat /path/to/output_prefix_posterior_similarity_matrix.txt \
    --clusterings /path/to/output_prefix_clusterings.txt \
    --criterion MPEAR \
    --post_process \
    --plot --plot_types png,pdf \
    --output /path/to/output_prefix_MPEAR_optimal_clustering.txt \
    --output_path_prefix /path/to/output_prefix_MPEAR
</code></pre></div></div>



			<div class="author">
				
				
				<div class="square-image" style="background-image: url('/../images/bebek-90.jpg')"></div>
				<p class="blurb">Gurkan is a bioinformatician, algorithm developer, implementer, database architect, sailor, potter, and father of two young kids.</p>
			</div>

			<div class="blog-navigation">
				
				
					<a class="next" href="//blog/academics/paper/journal/writing/2023/01/03/writing_log/">Writing logs to improve your output &raquo;</a>
				
			</div>


			
		</div>
	</div>
</section>



		<footer>
			<div class="container">
				<p class="editor-link"><a href="cloudcannon:collections/_data/footer.yml" class="btn"><strong>&#9998;</strong> Edit footer</a></p>
				<ul class="footer-left-links">
					
						<li>
							<a  href="//about/" >
								
								About
							</a>
						</li>
					
						<li>
							<a  href="//papers/" >
								
								Contributions
							</a>
						</li>
					
						<li>
							<a  href="//blog/" >
								
								Blog
							</a>
						</li>
					
						<li>
							<a  href="//contact/" >
								
								Contact
							</a>
						</li>
					
				</ul>
				<ul class="footer-right-links">
					
						<li>
							<a target="_blank" href="https://github.com/bebeklab" class="github-icon">
								
		<svg fill="#000000" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/></svg>
	

								
							</a>
						</li>
					
						<li>
							<a target="_blank" href="https://twitter.com/gbphd" class="twitter-icon">
								
		<svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M22.46,6C21.69,6.35 20.86,6.58 20,6.69C20.88,6.16 21.56,5.32 21.88,4.31C21.05,4.81 20.13,5.16 19.16,5.36C18.37,4.5 17.26,4 16,4C13.65,4 11.73,5.92 11.73,8.29C11.73,8.63 11.77,8.96 11.84,9.27C8.28,9.09 5.11,7.38 3,4.79C2.63,5.42 2.42,6.16 2.42,6.94C2.42,8.43 3.17,9.75 4.33,10.5C3.62,10.5 2.96,10.3 2.38,10C2.38,10 2.38,10 2.38,10.03C2.38,12.11 3.86,13.85 5.82,14.24C5.46,14.34 5.08,14.39 4.69,14.39C4.42,14.39 4.15,14.36 3.89,14.31C4.43,16 6,17.26 7.89,17.29C6.43,18.45 4.58,19.13 2.56,19.13C2.22,19.13 1.88,19.11 1.54,19.07C3.44,20.29 5.7,21 8.12,21C16,21 20.33,14.46 20.33,8.79C20.33,8.6 20.33,8.42 20.32,8.23C21.16,7.63 21.88,6.87 22.46,6Z" /></svg>
	

								
							</a>
						</li>
					
						<li>
							<a target="_blank" href="https://www.linkedin.com/in/gurkanbebek" class="linkedin-icon">
								
		<svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M19,19H16V13.7A1.5,1.5 0 0,0 14.5,12.2A1.5,1.5 0 0,0 13,13.7V19H10V10H13V11.2C13.5,10.36 14.59,9.8 15.5,9.8A3.5,3.5 0 0,1 19,13.3M6.5,8.31C5.5,8.31 4.69,7.5 4.69,6.5A1.81,1.81 0 0,1 6.5,4.69C7.5,4.69 8.31,5.5 8.31,6.5A1.81,1.81 0 0,1 6.5,8.31M8,19H5V10H8M20,2H4C2.89,2 2,2.89 2,4V20A2,2 0 0,0 4,22H20A2,2 0 0,0 22,20V4C22,2.89 21.1,2 20,2Z" /></svg>
	

								
							</a>
						</li>
					
						<li>
							<a  href="//feed.xml" class="rss-icon">
								
		<svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><circle cx="6.18" cy="17.82" r="2.18"/><path d="M4 4.44v2.83c7.03 0 12.73 5.7 12.73 12.73h2.83c0-8.59-6.97-15.56-15.56-15.56zm0 5.66v2.83c3.9 0 7.07 3.17 7.07 7.07h2.83c0-5.47-4.43-9.9-9.9-9.9z"/></svg>
	

								
							</a>
						</li>
					
				</ul>
				<p class="copyright"><a href="https://case.edu">CWRU</a> | <a href="https://case.edu/medicine/nutrition/sybb/sybb-ms">SYBB-MS</a> | <a href="https://case.edu/medicine/research/som-core-facilities/bioinformatics-and-biostatistics-core">Bioinformatics Core</a></p>
			</div>
		</footer>

		<script src="//ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
		<script src="//js/main.js"></script>
	</body>
</html>
